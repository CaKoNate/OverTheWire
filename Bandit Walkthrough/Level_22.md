# 🏴 Bandit Level 22 → Level 23 – Step-by-Step Guide

---

## 🎯 Level Goal

A program is running automatically at regular intervals from cron, the time-based job scheduler.  
Your task is to **inspect the cronjob and the script it runs** to figure out how to retrieve the password for user `bandit23`.

📌 **Note**:  
The shell script used in this level is **intentionally easy to read**.  
If you’re unsure what it does, try running the same commands manually to understand it.

---

## 🧭 Step-by-Step Instructions

### 📁 Step 1: Inspect the Cronjob

List all cronjob files:

```bash
ls -l /etc/cron.d/
```

Look for:

```text
cronjob_bandit23
```

Read its contents:

```bash
cat /etc/cron.d/cronjob_bandit23
```

📄 Expected output:

```cron
* * * * * bandit23 /usr/bin/cronjob_bandit23.sh &> /dev/null
```

This line means that every minute, the script `/usr/bin/cronjob_bandit23.sh` is executed as user `bandit23`, and any output is discarded.

---

### 📄 Step 2: Read the Script

View the contents of the script:

```bash
cat /usr/bin/cronjob_bandit23.sh
```

You should see:

```bash
#!/bin/bash

myname=$(whoami)
mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)
cat /tmp/$mytarget
```

#### 🔍 Explanation:

- `myname=$(whoami)`  
  → Stores the current username, likely `bandit23`, into the variable `myname`.

- `mytarget=$(echo I am user $myname | md5sum | cut -d ' ' -f 1)`  
  → Forms the string `I am user bandit23`, computes its MD5 hash, and stores only the hash value (first field).

- `cat /tmp/$mytarget`  
  → Displays the contents of the file located at `/tmp/<hash>`. That file contains the password for `bandit23`.

---

### 🔑 Step 3: Simulate the Script Manually

Recreate what the script does manually:

```bash
echo I am user bandit23 | md5sum
```

🔢 Example output:

```text
8ca319486bfbbc3663ea0fbe81326349  -
```

Now read the password file:

```bash
cat /tmp/8ca319486bfbbc3663ea0fbe81326349
```

🎉 This will output the password for **Bandit Level 23**.

---

## ✅ Summary Table

| Task | Command |
|------|---------|
| Check cronjob | `cat /etc/cron.d/cronjob_bandit23` |
| View cron script | `cat /usr/bin/cronjob_bandit23.sh` |
| Generate hashed filename | `echo I am user bandit23 \| md5sum` |
| Read password | `cat /tmp/<hash>` |

---

## 🚀 Connect to the Next Level

```bash
ssh bandit23@bandit.labs.overthewire.org -p 2220
```

---

## 💡 Notes

- The password file is regenerated by cron every minute. If you get an error when trying to `cat` the file, wait a few seconds and retry.
- Understanding string manipulation and MD5 hashing is key to solving this level.
